---
title: "Explore Pace"
description: |
  How fast are we distributing COVID-19 Vaccines? <ul class="list-inline title-nav"> 
  <li class="list-inline-item-nav"><div class = "go-to-nav" >Go to: </div></li>
  <li class="list-inline-item-nav">
    <a href="providers.html"> <button type="button" class="btn btn-outline-light mb-2"> Providers </button> 
    </a>
  </li>
  <li class="list-inline-item-nav">
    <a href="equity.html"> <button type="button" class="btn btn-outline-light mb-2"> Equity </button> 
    </a>
  </li>
  </ul>
output: 
  distill::distill_article:
    toc: true
    css: pace_header.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set()
library(gt)
library(tidyverse)
library(ggforce)
library(highcharter)
library(readxl)
library(janitor)
library(reactable)
library(htmltools)
library(tippy)

today <- Sys.Date()
today_lbl <- format(Sys.Date(), format = "%b %d, %Y")
time_lbl <- format(Sys.time(), format = "%I:%M %p")

src <- "https://dshs.texas.gov/immunize/covid19/COVID-19-Vaccine-Data-by-County.xls" # URL For Daily COVID Data
lcl <- basename(src)
filepath <- paste0("raw_data/", today,"_",lcl,"x")
download.file(url = src, destfile = filepath) # Downloads The Data

src_providers <- "https://genesis.soc.texas.gov/files/accessibility/vaccineprovideraccessibilitydata.csv"
lcl_providers <- basename(src_providers)
filepath_providers <- paste0("raw_data/",today,"_",lcl_providers)
download.file(url = src_providers, destfile = filepath_providers)


with_tooltip <- function(value, tooltip, ...) {
  div(style = "text-decoration: underline; text-decoration-style: dotted; cursor: help",
      tippy(value, tooltip, ...))
}

bar_chart <- function(label, width = "100%", height = "16px", fill = "#005f86", background = NULL) {
  bar <- div(style = list(background = fill, width = width, height = height))
  chart <- div(style = list(flexGrow = 1, marginLeft = "8px", background = background), bar)
  div(style = list(display = "flex", alignItems = "center"), label, chart)
}


vaccine_hc <- hc_theme_merge(
  hc_theme_smpl(),
  hc_theme(chart = list(backgroundColor = "#fff", 
                        style = list(fontFamily = '"Libre Franklin", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif', 
                                     fontSize = "28px",  fontWeight = "bold",
                                     color="#333f48", textTransform="initial")),
           title = list(style = list(fontFamily = '"Libre Franklin", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif', 
                                     fontWeight="bold",
                                     color="#333f48"),
                        align = "left"), 
           subtitle = list(style = list(fontFamily = '"Libre Franklin", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',
                                        color="#7d7d7d",
                                        textTransform="initial",
                                        fontWeight="400",
                                        fontSize = "14px"),
                           align = "left"), 
           legend = list(align = "right", 
                         style = list(fontFamily = '"Libre Franklin", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif', color="#6d6d6d"),
                         itemStyle = list(fontFamily = '"Libre Franklin", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif', color = '#6d6d6d'),
                         itemHoverStyle = list(color = 'gray'),   
                         verticalAlign = "top"),
           credits = list(style = list(color = "#8d8d8d")),
           xAxis = list(labels =list(style = list(fontFamily = '"Libre Franklin", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif', color="#2d2d2d")), 
                        title = list(style = list(color = "#333f48", fontSize = "12px", 
                                                  color="#333f48",fontWeight="500")),
                        gridLineWidth = 0,
                        gridLineColor = "#9d9d9d", 
                        lineColor = 'rgba(0,0,0,0.7)', 
                        minorGridLineColor = 'rgba(0,0,0,0.7)', 
                        tickColor = "#9d9d9d", 
                        tickWidth = 1), 
           yAxis = list(labels =list(style = list(fontFamily = '"Libre Franklin", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif', color="#2d2d2d")), 
                        title = list(style = list(color = "#333f48", fontSize = "12px", 
                                                  color="#333f48",fontWeight="500")), 
                        gridLineWidth = .5,
                        gridLineColor = 'rgba(0,0,0,0.15)', 
                        lineColor = 'rgba(0,0,0,0.15)', 
                        minorGridLineColor = 'rgba(0,0,0,0.15)', 
                        tickColor = "#9d9d9d", 
                        tickWidth = 2)))
  
```


# Pace Overview

## Texas Summary

The chart attempts to capture a holistic snapshot of multiple data points related to state's current efforts to vaccinate the population. At a high level, this chart is a single box that represents everyone in Texas aged 16 years and older. Within the box, you can see how much of is made up of eligible phases and how much of it is made up of the remaining population aged 16 years and older. And then, two lines mark the following:

* **Doses Shipped:** How many doses have been shipped compared to the entire 16+ population?
* **Persons Fully Vaccinated:** How many people have been fully vaccinated compared to the entire 16+ population?

```{r echo=FALSE, fig.width=11, layout="l-page"}

vaccine_summ <- read_excel(filepath, sheet = "By County", skip=0) %>% 
  clean_names() %>% 
  filter(county_name=="Texas") %>% 
  mutate(across(total_doses_allocated:population_16_64_any_medical_condition, as.numeric)) %>%
  select(county_name, population_16, people_fully_vaccinated, total_doses_allocated, 
         starts_with("population_phase_"), population_16_64_any_medical_condition) %>% 
  mutate(population_phase_remaining = population_16 - (population_phase_1a_healthcare_workers +
                                                       population_phase_1a_long_term_care_residents +
                                                       population_16_64_any_medical_condition),
         remaining_box_start = population_16 - population_phase_remaining) %>%
  rename(`Phase 1A - Healthcare Workers`=population_phase_1a_healthcare_workers, 
         `Phase 1A - Long Term Care`=population_phase_1a_long_term_care_residents, 
         `Phase 1B - 65+ and High Risk`=population_16_64_any_medical_condition,
         `Future Phases`=population_phase_remaining) %>%
  pivot_longer(cols=contains("Phase"), names_to = "phase_pop_est", values_to = "value") %>%
  mutate(order = case_when(
    phase_pop_est == "Phase 1A - Healthcare Workers" ~ 1,
    phase_pop_est == "Phase 1A - Long Term Care" ~ 2,
    phase_pop_est == "Phase 1B - 65+ and High Risk" ~ 3,
  ),
  prev_1 = lag(value, 1),
  prev_2 = lag(value, 2),
  prev_1 = replace_na(prev_1, 0),
  prev_2 = replace_na(prev_2, 0)) %>% 
  mutate(lab_pos = (value/2) + (prev_1 + prev_2)) 

box_start <- unique(vaccine_summ$remaining_box_start)
box_end <- unique(vaccine_summ$population_16)
fully_vac_lbl <- scales::comma(unique(vaccine_summ$people_fully_vaccinated))
shipped_lbl <- scales::comma(unique(vaccine_summ$total_doses_allocated))
fully_vac_xend <- unique(vaccine_summ$people_fully_vaccinated)
shipped_xend <- unique(vaccine_summ$total_doses_allocated)

vaccine_summ %>%
  ggplot() +
  geom_col(data = . %>%  slice(1), aes(y=county_name, x=population_16), fill = "#333f48", alpha = .05) +
  geom_col(data = vaccine_summ %>% filter(phase_pop_est != "Future Phases"), aes(y=county_name, x=value, fill = reorder(phase_pop_est,desc(order))), alpha=.7) +
  annotate(geom = "rect", alpha = 0, color = "#333f48", linetype = 2, 
           xmin = box_start, xmax = box_end, ymin = .55, ymax = 1.45) +
  geom_text(data = . %>% filter(phase_pop_est != "Future Phases"), angle=90, color="white", size = 3, family = "Graphik-Semibold",
            aes(y=county_name, x=lab_pos, label = reorder(phase_pop_est,desc(order)))) +
  geom_text(data = vaccine_summ %>% filter(phase_pop_est == "Future Phases"), color="#2d2d2d", size = 6,  hjust = 0.35,
            family = "Graphik-Semibold", aes(y=county_name, x=lab_pos), label = "Remaining Pop. (16+) in Future Phases") +
  geom_vline(aes(xintercept=total_doses_allocated), linetype = 2, size = .9, color = "#2d2d2d") +
  geom_vline(aes(xintercept=people_fully_vaccinated), linetype = 2, size = .9, color = "#2d2d2d") +
  scale_x_continuous(labels = scales::unit_format(unit = "M", accuracy = 1, scale = 1e-6)) +
  scale_fill_manual(values = c("#005f86",  "#9cadb7","#bf5700")) +
  guides(fill=guide_legend(title = "Legend",
                           keyheight = .8)) +
  annotate(
    geom = "curve", color = "#2d2d2d", x = shipped_xend*1.15, y = 1.55, xend = shipped_xend*1.02, yend = 1.5,
    curvature = .1, arrow = arrow(length = unit(2, "mm"))
  ) +
  annotate(geom = "label", x = shipped_xend*1.17, y = 1.53, color = "#2d2d2d", 
           label = glue::glue("Doses Shipped: {shipped_lbl}"), family = "Graphik", hjust = "left") +
  annotate(
    geom = "curve", color = "#2d2d2d", x = fully_vac_xend*2.25, y = .48, xend = fully_vac_xend*1.2, yend = .54 , 
    curvature = 0, arrow = arrow(length = unit(2, "mm"))
  ) +
  annotate(geom = "label", x = fully_vac_xend*2.5, y = .5, color = "#2d2d2d", 
           label = glue::glue("Persons Fully Vacinated: {fully_vac_lbl}"), family = "Graphik", hjust = "left") +
  theme_minimal(base_family = "Graphik") +
  theme(plot.title = element_text(family = "Graphik-Bold", color = "#333f48", size =20),
        plot.subtitle = element_text(family = "Graphik-Regular", color = "#333f48", margin = margin(b=15)),
        panel.grid.major.y = element_blank(),
        plot.margin = margin(t=15, r=15, b=10, l = 15),
        axis.text.y = element_blank(),
        legend.position = "none") +
  labs(title = "Texas Summary of Vaccination Progress",
       subtitle = paste0("Source: Texas Department of State Health Services. Last pulled on ", today_lbl, " at ", time_lbl),
       x = NULL,
       y = NULL,
       color = NULL,
       caption = "Data File: 'Accessible Vaccine Dashboard Data'\nLink: https://dshs.texas.gov/immunize/covid19/COVID-19-Vaccine-Data-by-County.xls\nChart by: @mrworthington") #+
  # ggsave(paste0("figures/",today,"_","tx_vaccine_summary.png"), dpi = 300, width = 11, height = 4.5)

```


## National Comparison

```{r echo=FALSE, layout = "l-body-outset"}

cdc_last_update <- "Feb 11, 2021" 
cdc_last_time <- "12:56PM"


  hcoptslang <- getOption("highcharter.lang")
  hcoptslang$thousandsSep <- ","
  options(highcharter.lang = hcoptslang)

cdc_vaccine_summary <- read_csv("raw_data/covid19_vaccinations_in_the_united_states-3.csv",
                                skip = 2, na = "N/A") %>% 
  clean_names() %>% 
  select(area=state_territory_federal_entity, contains("_per_100k")) %>%
  mutate_at(vars(contains("_per_100k")), as.numeric) %>% 
  drop_na(delivered_per_100k)

cdc_vaccine_column <- cdc_vaccine_summary %>%
  mutate_at(vars(contains("_per_100k")), as.numeric) %>% 
  pivot_longer(cols=2:5,
               names_to = "type",
               values_to = "value") %>% 
  group_by(type) %>% 
  mutate(rank = dense_rank(desc(value))) %>% 
  filter(area=="Texas") %>% 
  rename(indicator=type) %>% 
  mutate(indicator = str_replace(indicator,"delivered_per_100k","Distributed"),
         indicator = str_replace(indicator,"administered_per_100k","Administered"),
         indicator = str_replace(indicator,"people_with_1_doses_per_100k","With 1 Dose"),
         indicator = str_replace(indicator,"people_with_2_doses_per_100k","With 2 Doses"))

cdc_vaccine_drilldown <- cdc_vaccine_summary %>%
  mutate_at(vars(contains("_per_100k")), as.numeric) %>% 
  pivot_longer(cols=2:5,
               names_to = "type",
               values_to = "value") %>% 
  group_by(type) %>% 
  mutate(rank = dense_rank(desc(value))) %>% 
  rename(indicator=type) %>% 
  mutate(indicator = str_replace(indicator,"delivered_per_100k","Distributed"),
         indicator = str_replace(indicator,"administered_per_100k","Administered"),
         indicator = str_replace(indicator,"people_with_1_doses_per_100k","With 1 Dose"),
         indicator = str_replace(indicator,"people_with_2_doses_per_100k","With 2 Doses")) %>% 
  group_nest(indicator) %>% 
  mutate(
    id = indicator,
    type = "column",
    data = map(data, mutate, name = area, y = value),
    data = map(data, list_parse))

x <- c("Value Per 100k: ", "{point.indicator} Rank: ")
y <- c("{point.value}", "{point.rank}")

tt <- tooltip_table(x, y, title = "{point.area}")

hchart(
  cdc_vaccine_column,
  "column",
  hcaes(x = indicator, y = value, name = indicator, drilldown = indicator),
  name = "Vaccine Indicators",
  colorByPoint = TRUE
) %>% 
  hc_drilldown(
    allowPointDrilldown = TRUE,
    series = list_parse(cdc_vaccine_drilldown)
  ) %>% 
  hc_title(text="How Texas Stacks Up Against All States, Territories, & US Entities.") %>%
  hc_subtitle(text=paste0("Date is from the CDC. Data reflects reporting as of ",cdc_last_update," at ", cdc_last_time)) %>% 
  hc_tooltip(
    pointFormat = tt, # "{point.name} {point.pop}"
    useHTML = TRUE,
    valueDecimals = 0
  ) %>% 
  hc_plotOptions(
    series = list(
      boderWidth = 0,
      dataLabels = list(enabled = TRUE,
                        format = "{point.rank}"),
      dataSorting = list(enabled = TRUE)
    )
  ) %>% 
  hc_yAxis(
    title = list(text = "Value (Per 100k)")
  ) %>% 
  hc_xAxis(
    title = list(text="Vaccine Indicators")
  ) %>% 
  hc_colors(colors = list('#005f86','#00a9b7','#9cadb7','#d6d2c4')) %>% 
  # hc_caption(text = "This is the caption") %>% 
  hc_credits(
    enabled = TRUE,
    text = "Source: 'COVID Data Tracker - Vaccines', Center for Disease Control.",
    href = "https://covid.cdc.gov/covid-data-tracker/#vaccinations") %>%
  hc_add_theme(vaccine_hc)
  
```

# Distribution Trends

The next chart captures where the reported supply of doses has been distributed, by the type of vaccine provider. The state classifies provider types, which allows to see very simply: what kinds of providers have recently received shipments of doses and how much were they shipped?

```{r echo=FALSE, fig.width=10, layout="l-page"}

supply_by_provider_type <- read_csv(filepath_providers, skip=0) %>%
  janitor::clean_names() %>% 
  group_by(type) %>% 
  summarise(tot_shipped = sum(total_shipped),
            tot_avail = sum(vaccines_available)) 

supply_by_provider_type %>%
  drop_na() %>%
  ggplot(aes(x=reorder(type, desc(tot_shipped)), y = tot_shipped, fill=type)) +
  geom_col() +
  theme_minimal(base_family = "Graphik") +
  geom_text(angle=90, color="#2d2d2d", size = 3.1, family = "Graphik-Semibold",
            aes(y= 0, x=type, label = type), hjust = 0) +
  scale_y_continuous(labels = scales::unit_format(unit = "K", accuracy = 1, scale = 1e-3)) +
  ggthemes::scale_fill_tableau(palette = "Tableau 20") +
  theme(plot.title = element_text(family = "Graphik-Bold", color = "#333f48", size =20),
        plot.subtitle = element_text(family = "Graphik-Regular", color = "#333f48", margin = margin(b=15)),
        panel.grid.major.y = element_blank(),
        plot.margin = margin(t=15, r=15, b=10, l = 15),
        axis.text.x = element_blank(),
        legend.position = "none") +
  labs(title = "Reported Total Supply by Provider Type",
       subtitle = paste0("Source: Texas Department of State Health Services. Last pulled on ", today_lbl, " at ", time_lbl),
       x = NULL,
       y = "Doses (Shipped)",
       color = NULL,
       caption = "Data File: 'Texas Vaccine Provider Data'\nLink: https://genesis.soc.texas.gov/files/accessibility/vaccineprovideraccessibilitydata.csv\nChart by: @mrworthington") #+
  # ggsave(paste0("figures/",today,"_","supply_by_provider_type.png"), dpi = 300, width = 11, height = 4.5)

```

Similar to the last one, this chart focuses on reported availability. In other words, how much of the shipped doses are provider types reporting to be still available at the time the chart was generated? 

```{r echo=FALSE, fig.width=10, layout="l-page"}

supply_by_provider_type %>% 
  drop_na() %>% 
  ggplot(aes(x=reorder(type, desc(tot_avail)), y = tot_avail, fill=type)) +
  geom_col() +
  theme_minimal(base_family = "Graphik") +
  geom_text(angle=90, color="#2d2d2d", size = 3.1, family = "Graphik-Semibold",
            aes(y= 0, x=type, label = type), hjust = 0) +
  scale_y_continuous(labels = scales::unit_format(unit = "K", accuracy = 1, scale = 1e-3)) +
  ggthemes::scale_fill_tableau(palette = "Tableau 20") +
  theme(plot.title = element_text(family = "Graphik-Bold", color = "#333f48", size =20),
        plot.subtitle = element_text(family = "Graphik-Regular", color = "#333f48", margin = margin(b=15)),
        panel.grid.major.y = element_blank(),
        plot.margin = margin(t=15, r=15, b=10, l = 15),
        axis.text.x = element_blank(),
        legend.position = "none") +
  labs(title = "Reported Availability by Provider Type",
       subtitle = paste0("Source: Texas Department of State Health Services. Last pulled on ", today_lbl, " at ", time_lbl),
       x = NULL,
       y = "Doses (Available)",
       color = NULL,
       caption = "Data File: 'Texas Vaccine Provider Data'\nLink: https://genesis.soc.texas.gov/files/accessibility/vaccineprovideraccessibilitydata.csv\nChart by: @mrworthington") #+
  # ggsave(paste0("figures/",today,"_","availability_by_provider_type.png"), dpi = 300, width = 11, height = 4.5)
```

<details class = "l-body">
<summary><strong>Notes about the table below</strong></summary>

* Data shown below comes from the "Accessible Vaccine Dashboard Data" published by the Texas Department of State Health Services, which can be found at this link: `r src`
* It was last pulled on `r today_lbl` at `r time_lbl`

</details>

<details class = "l-body">
<summary><strong> Data dictionary for the table below </strong></summary>

* **County**: This comes from the DSHS "Accessible Vaccine Dashboard Data" file and represents the county for which DSHS has collected data.
* **Popuplation (16+)"**:  This comes from the DSHS "Accessible Vaccine Dashboard Data" file and represents the number of persons aged 16 years and older in Texas. This number is reported given that vaccines authorized for emergency use have only authorized for use in persons aged 16 years and older. 
* **Total Doses Allocated**: This comes from the DSHS "Accessible Vaccine Dashboard Data" file and represents the number of total doses allocated/shipped to a given Texas county.
* **Full Vaccinations**: This comes from the DSHS "Accessible Vaccine Dashboard Data" file and represents the number of persons who are fully vaccinated in a given Texas county.
* **Doses Allocated (Per Capita)**: This is a custom calculation that is derived by taking the number of total doses allocated and dividing it by the population aged 16 years and older, both numbers provided by DSHS. The result of that is then multipled by 100,000 for standardization and rounded up.  
* **Full Vaccinations (Per Capita)**: This is a custom calculation that is derived by taking the number of persons who are fully vaccinated and dividing it by the population aged 16 years and older, both numbers provided by DSHS. The result of that is then multipled by 100,000 for standardization and rounded up.  

</details>

## Vaccine Data Table 

```{r echo=FALSE, message=FALSE, warning=FALSE, layout="l-screen-inset"}

vaccine_cnty_summ <- read_excel(filepath, sheet = "By County", skip=0) %>% 
  clean_names() %>% 
  filter(county_name!="Texas" & county_name!="Federal Long-Term Care Vaccination Program" & county_name!="*Other") %>% 
  select(county_name, population_16, people_fully_vaccinated, total_doses_allocated) %>% 
  mutate(population_16 = as.numeric(population_16), 
         people_fully_vaccinated = as.numeric(people_fully_vaccinated), 
         total_doses_allocated = as.numeric(total_doses_allocated)) %>% 
  mutate(doses_allocated_per_cap = round((total_doses_allocated/population_16)*100000, digits=0),
         fully_vaccinated_per_cap = round((people_fully_vaccinated/population_16)*100000, digits=0)) %>% 
  select(county_name, population_16, total_doses_allocated, doses_allocated_per_cap, people_fully_vaccinated, fully_vaccinated_per_cap) %>%   
  arrange(desc(population_16))

reactable(data =vaccine_cnty_summ,
            searchable = TRUE,
            striped = TRUE,
            highlight = TRUE,
            bordered = TRUE,
            pagination = TRUE,
            showSortIcon = TRUE ,
            defaultPageSize = 15,
            resizable = TRUE,
            fullWidth = TRUE,
            compact = TRUE,
            theme = reactableTheme(
              color = "#2d2d2d",
              backgroundColor = "rgba(255,255,255,1)",
              borderColor = "rgba(255,255,255,.2)",
              headerStyle = list(background = "#333f48", 
                                 color = "#fff",
                                 fontWeight="700", 
                                 letterSpacing="1px", 
                                 fontSize="15px"),
              highlightColor = "#9cadb7",
              cellPadding = "8px 12px",
              style = list(fontSize = "14px",
                           fontFamily = "'Libre Franklin', -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif"),
              searchInputStyle = list(width = "100%")),
          columns = list(
            county_name = colDef(name = "County", show = TRUE, width = 110,
                                 style = list(borderRight = "1px solid rgba(0, 0, 0, 0.1)")),
            population_16 = colDef(show = TRUE, width = 180,
                                   header = with_tooltip("Population (16+)", "Number of Persons"),
                                   format = colFormat(separators = TRUE),
                                   align = "center",
                                   style = list(borderRight = "1.5px solid rgba(0, 0, 0, 0.2)")),
            total_doses_allocated = colDef(show = TRUE, format = colFormat(separators = TRUE),
                                           align = "center", 
                                           width = 250,
                                           header = with_tooltip("Total Doses Allocated", "Number of Doses Allocated")),
            doses_allocated_per_cap = colDef(show = TRUE,
                                             header = with_tooltip("Doses Allocated (Per Capita)", "Number of Doses Allocated for every 100,000 persons"),
                                             style = list(borderRight = "1.5px solid rgba(0, 0, 0, 0.2)", fontFamily = "Fira Code", whiteSpace = "pre"),
                                             align = "left",
                                             cell = function(value) {
                                                       width <- paste0(value * 100 / max(vaccine_cnty_summ$doses_allocated_per_cap, na.rm = TRUE), "%")
                                                       # Add thousands separators
                                                       value <- format(value, big.mark = ",")
                                                       # Fix each label using the width of the widest number (incl. thousands separators)
                                                       value <- format(value, width = 9, justify = "right")
                                                       bar_chart(value, width = width, fill = "#bf5700")
                                             }),
            people_fully_vaccinated = colDef(show = TRUE,  
                                             format = colFormat(separators = TRUE),
                                             align = "center", 
                                             width = 250,
                                             header = with_tooltip("Full Vaccinations", "Number of Persons")),
            fully_vaccinated_per_cap = colDef(show = TRUE,
                                              header = with_tooltip("Full Vaccinations (Per Capita)", "For every 100,000 persons, how many would be fully vaccinated?"),
                                             style = list(borderRight = "1.5px solid rgba(0, 0, 0, 0.2)", fontFamily = "Fira Code", whiteSpace = "pre"),
                                              align = "left",
                                              cell = function(value) {
                                               width <- paste0(value * 100 / max(vaccine_cnty_summ$fully_vaccinated_per_cap, na.rm = TRUE), "%")
                                               value <- format(value, big.mark = ",")
                                               # Fix each label using the width of the widest number (incl. thousands separators)
                                               value <- format(value, width = 9, justify = "right")                                              
                                               bar_chart(value, width = width)
                                             })))

```

# Vaccine Pace Tracker

```{r echo=FALSE, message=FALSE, warning=FALSE, layout = "l-page"}
knitr::include_app("https://mrworthington.shinyapps.io/tx_vaccine-pace/", height = "1800px")
```

## Photography Credit {.appendix}

<span>Photo by <a href="https://unsplash.com/@schluditsch?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Daniel Schludi</a> on <a href="https://unsplash.com/s/photos/vaccine-covid?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span>